# è¿æ¥è¢«æ‹’ç»ï¼ˆERR_CONNECTION_REFUSEDï¼‰æ’æŸ¥

## ğŸ” é—®é¢˜ç°è±¡

- å®¹å™¨å·²å¯åŠ¨ï¼š`Up Less than a second`
- ç«¯å£æ˜ å°„æ­£ç¡®ï¼š`0.0.0.0:8028->8028/tcp`
- ä½†è¿æ¥è¢«æ‹’ç»ï¼š`curl: (7) Failed to connect to localhost port 8028`

## ğŸ“‹ å¯èƒ½åŸå› 

### 1. **æœåŠ¡è¿˜åœ¨å¯åŠ¨ä¸­**ï¼ˆæœ€å¸¸è§ï¼‰

å®¹å™¨åˆšå¯åŠ¨ï¼ŒGunicorn éœ€è¦å‡ ç§’åˆ°å‡ åç§’æ‰èƒ½å®Œå…¨å¯åŠ¨ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# ç­‰å¾… 10-20 ç§’åé‡è¯•
sleep 15
curl http://localhost:8028/api/docs

# æˆ–ä½¿ç”¨å¿«é€Ÿæ£€æŸ¥è„šæœ¬
./quick-check.sh
```

### 2. **API æœåŠ¡å™¨å¯åŠ¨å¤±è´¥**

Gunicorn å¯åŠ¨å¤±è´¥ï¼Œå®¹å™¨è™½ç„¶è¿è¡Œä½†æœåŠ¡æœªå¯åŠ¨ã€‚

**æ£€æŸ¥æ–¹æ³•ï¼š**
```bash
# æŸ¥çœ‹å®Œæ•´æ—¥å¿—
docker compose logs api-server

# æŸ¥çœ‹æœ€è¿‘ 50 è¡Œ
docker compose logs api-server --tail 50
```

**å¸¸è§é”™è¯¯ï¼š**
- `ModuleNotFoundError: No module named 'paramiko'` â†’ éœ€è¦é‡æ–°æ„å»ºé•œåƒ
- `Worker failed to boot` â†’ æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯
- `GIBH-AGENT åˆå§‹åŒ–å¤±è´¥` â†’ æ£€æŸ¥é…ç½®å’Œ API Key

### 3. **ç«¯å£ç»‘å®šé—®é¢˜**

Gunicorn å¯èƒ½ç»‘å®šåˆ°äº†é”™è¯¯çš„åœ°å€ã€‚

**æ£€æŸ¥æ–¹æ³•ï¼š**
```bash
# è¿›å…¥å®¹å™¨æ£€æŸ¥
docker compose exec api-server bash
# åœ¨å®¹å™¨å†…ï¼š
netstat -tlnp | grep 8028
# æˆ–
ss -tlnp | grep 8028
```

## âœ… è§£å†³æ­¥éª¤

### æ­¥éª¤ 1ï¼šç­‰å¾…å¹¶é‡è¯•

```bash
# ç­‰å¾… 15 ç§’
sleep 15

# å†æ¬¡æµ‹è¯•
curl http://localhost:8028/api/docs
```

### æ­¥éª¤ 2ï¼šæŸ¥çœ‹æ—¥å¿—

```bash
# æŸ¥çœ‹å®Œæ•´å¯åŠ¨æ—¥å¿—
docker compose logs api-server

# å¦‚æœçœ‹åˆ°é”™è¯¯ï¼Œæ ¹æ®é”™è¯¯ä¿¡æ¯å¤„ç†
```

### æ­¥éª¤ 3ï¼šæ£€æŸ¥å®¹å™¨çŠ¶æ€

```bash
# æŸ¥çœ‹å®¹å™¨è¯¦ç»†çŠ¶æ€
docker compose ps api-server

# å¦‚æœçŠ¶æ€ä¸æ˜¯ "Up"ï¼ŒæŸ¥çœ‹æ—¥å¿—
docker compose logs api-server --tail 100
```

### æ­¥éª¤ 4ï¼šé‡æ–°æ„å»ºï¼ˆå¦‚æœéœ€è¦ï¼‰

å¦‚æœæ—¥å¿—æ˜¾ç¤ºä¾èµ–ç¼ºå¤±æˆ–å…¶ä»–æ„å»ºé—®é¢˜ï¼š

```bash
# åœæ­¢å®¹å™¨
docker compose down

# é‡æ–°æ„å»º
docker compose build --no-cache api-server

# å¯åŠ¨
docker compose up -d api-server

# ç­‰å¾…å¹¶æ£€æŸ¥
sleep 15
docker compose logs api-server --tail 30
curl http://localhost:8028/api/docs
```

## ğŸ”§ å¿«é€Ÿè¯Šæ–­è„šæœ¬

å·²åˆ›å»ºä¸¤ä¸ªè¯Šæ–­è„šæœ¬ï¼š

1. **`quick-check.sh`** - å¿«é€Ÿæ£€æŸ¥ï¼ˆç­‰å¾… + æµ‹è¯•ï¼‰
2. **`check-api-status.sh`** - è¯¦ç»†è¯Šæ–­

è¿è¡Œï¼š
```bash
./quick-check.sh
```

## ğŸ“ éªŒè¯ä¿®å¤

ä¿®å¤ååº”è¯¥çœ‹åˆ°ï¼š

```bash
# 1. å®¹å™¨çŠ¶æ€æ­£å¸¸
docker compose ps api-server
# åº”è¯¥æ˜¯ "Up" çŠ¶æ€ï¼Œä¸”è¿è¡Œæ—¶é—´ > 10 ç§’

# 2. æ—¥å¿—æ˜¾ç¤ºå¯åŠ¨æˆåŠŸ
docker compose logs api-server | grep -E "Listening|started|æˆåŠŸ"
# åº”è¯¥çœ‹åˆ°ç±»ä¼¼ï¼šListening at: http://0.0.0.0:8028

# 3. å¯ä»¥è®¿é—®
curl http://localhost:8028/api/docs
# åº”è¯¥è¿”å› HTML å†…å®¹ï¼ˆSwagger UIï¼‰
```

## ğŸ†˜ å¦‚æœä»ç„¶æ— æ³•è§£å†³

1. **æ”¶é›†å®Œæ•´ä¿¡æ¯ï¼š**
   ```bash
   docker compose ps > container-status.txt
   docker compose logs api-server > api-logs.txt 2>&1
   ```

2. **æ£€æŸ¥ç³»ç»Ÿèµ„æºï¼š**
   ```bash
   free -h
   docker stats --no-stream
   ```

3. **å°è¯•ç›´æ¥è¿è¡Œï¼ˆç»•è¿‡ Dockerï¼‰ï¼š**
   ```bash
   # åœæ­¢ Docker å®¹å™¨
   docker compose down
   
   # ç›´æ¥è¿è¡Œ server.py
   python server.py
   # ç„¶åè®¿é—® http://localhost:8018ï¼ˆserver.py é»˜è®¤ç«¯å£ï¼‰
   ```

